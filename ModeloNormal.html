<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Rodrigo Zepeda" />


<title>Distribución Gaussiana (alias ‘La Normal’)</title>

<script src="ModeloNormal_files/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="ModeloNormal_files/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="ModeloNormal_files/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="ModeloNormal_files/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="ModeloNormal_files/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="ModeloNormal_files/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="ModeloNormal_files/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="ModeloNormal_files/tocify-1.9.1/jquery.tocify.js"></script>
<script src="ModeloNormal_files/navigation-1.1/tabsets.js"></script>
<link href="ModeloNormal_files/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="ModeloNormal_files/highlightjs-9.12.0/highlight.js"></script>
<!-- Meta characteristics -->
<meta name="description" content="Notas de Probabilidad">
<meta name="keywords" content="Probabilidad, Cálculo de Probabilidades, Matemáticas, Curso de Matemáticas, Notas de Clase,
Conteo">
<meta name="author" content="Rodrigo Zepeda Tello">

<!-- Add d3js -->
<script src="https://d3js.org/d3.v4.min.js"></script>

<!-- Nice mathjax format -->
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({ tex2jax: { inlineMath: [['$','$'], ['\\(','\\)']], processEscapes: true, }, TeX: { equationNumbers: { autoNumber: "AMS" } } });
</script>

<style>
td {
   padding-left: 2px;
}
</style>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>

<link rel="stylesheet" href="css/bootstrap.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>



<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}


.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">



<!--Navigation menu-->
<link href="css/custom.css" rel="stylesheet">
<nav class="navbar navbar-default navbar-fixed-top">
    <div class="container">
        <div class="navbar-header">
            <button class="navbar-toggle" type="button" data-toggle="collapse" data-target="#navbar-main">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
        </button>
            <a class="navbar-brand" href="https://rodrigozepeda.github.io/Probabilidad/">Notas de Cálculo de Probabilidades</a>
        </div>

        <div class="collapse navbar-collapse" id="navbar-main">
            <!--<ul class="nav navbar-nav">
                <li><a href="#">Link</a></li>
                <li><a href="#">Link</a></li>
            </ul>-->
            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="https://github.com/RodrigoZepeda/Probabilidad"><img src="images/GitHub-Mark-Light-32px.png"></a>
                </li>
            </ul>
        </div>
    </div>
</nav>

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Distribución Gaussiana (alias ‘La Normal’)</h1>
<h4 class="author">Rodrigo Zepeda</h4>

</div>


<p><img src="images/paranormal.jpg" width="50%" style="display: block; margin: auto;" /></p>
<div id="deducción-del-modelo" class="section level1">
<h1><span class="header-section-number">1</span> Deducción del Modelo</h1>
<p>Pensemos que estamos midiendo la posición de las estrellas en el cielo. Para ello hay dos formas.</p>
<p><img src="ModeloNormal_files/figure-html/unnamed-chunk-2-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>Bajo coordenadas cartesianas <span class="math inline">\((x,y)\)</span> pensemos que el error de medición es independiente; es decir, si <span class="math inline">\(\rho(x,y)\)</span> es la densidad conjunta de los errores en cada coordenada entonces:</p>
<p><span class="math display">\[
\rho (x,y) = f_X(x) f_Y(y) 
\]</span></p>
<p>Podemos asumir que los errores de medición tienen la misma distribución en la coordenada <span class="math inline">\(x\)</span> que la coordenada <span class="math inline">\(y\)</span>:</p>
<p><span class="math display">\[
\rho (x,y) = f_X(x) f_X(y) 
\]</span></p>
<p>Por otro lado, supongamos que existe también una representación en coordenadas polares de la posición de la estrella: <span class="math display">\[
p (r, \theta)  = g_R(r) 
\]</span></p>
<p>donde el error de medición depende sólo del radio <span class="math inline">\(R\)</span> (no del ángulo).</p>
<p><img src="ModeloNormal_files/figure-html/unnamed-chunk-3-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>Notamos entonces que:</p>
<p><span class="math display">\[
f_X(x) f_X(y) = g_R\Big( \sqrt{x^2 + y^2} \Big) 
\]</span> donde sustituimos <span class="math inline">\(r\)</span> por su definición en coordenadas polares. Si tomamos <span class="math inline">\(y = 0\)</span> tenemos que <span class="math inline">\(f_X(x) f_X(0) = g_R(x)\)</span> (a partir de aquí supondré <span class="math inline">\(x &gt; 0\)</span>; los otros casos son similares). A partir de esa expresión se tiene que:</p>
<p><span class="math display">\[
f_X(\sqrt{x^2 + y^2} ) f_X(0) = g_R(\sqrt{x^2 + y^2} )
\]</span></p>
<p>Podemos entonces sustituir:</p>
<p><span class="math display">\[
f_X(x) f_X(y) = f_X(\sqrt{x^2 + y^2} ) f_X(0)
\]</span></p>
<p>y dividimos entre <span class="math inline">\(f_X(0)^2\)</span> para normalizar:</p>
<p><span class="math display">\[
\dfrac{f_X(x) \cdot f_X(y)}{f_X(0)\cdot f_X(0)} = \dfrac{f_X\Big( \sqrt{x^2 + y^2} \Big) }{f_X(0)}
\]</span></p>
<p>Tomamos logaritmo: <span class="math display">\[
\ln \Big(\dfrac{f_X(x)}{f_X(0)}\Big) + \ln \Big(\dfrac{f_X(y)}{f_X(0)}\Big)  = \ln \Bigg( \dfrac{f_X\Big( \sqrt{x^2 + y^2} \Big) }{f_X(0)} \Bigg)
\]</span></p>
<p>Si reescribimos <span class="math inline">\(h(x) = \ln \Big(\dfrac{f_X(x)}{f_X(0)}\Big)\)</span> tenemos entonces que el problema es hallar una función <span class="math inline">\(h\)</span> tal que:</p>
<p><span class="math display">\[
h(x) + h(y) = h\Big(\sqrt{x^2+y^2}\Big)
\]</span></p>
<p>Pensando que dicha función es diferenciable podríamos buscarla haciendo:</p>
<p><span class="math display">\[
\dfrac{\partial}{\partial x} \Big[ h(x) + h(y) \Big] = \dfrac{\partial}{\partial x} h\Big(\sqrt{x^2+y^2}\Big)
\]</span></p>
<p>De donde obtenemos:</p>
<p><span class="math display">\[
h&#39;(x) = h&#39;(\sqrt{x^2 + y^2}) \dfrac{x}{\sqrt{x^2+y^2}}
\]</span></p>
<p>Notamos entonces que:</p>
<p><span class="math display">\[
\dfrac{h&#39;(x)} {h&#39;(\sqrt{x^2 + y^2})}= \dfrac{x}{\sqrt{x^2+y^2}}
\]</span></p>
<p>Por lo cual, una propuesta para <span class="math inline">\(h&#39;(x) = \alpha x\)</span> para alguna <span class="math inline">\(\alpha\)</span> (no es la única solución al problema, de hecho hay infinitas) y se sigue que <span class="math inline">\(h(x) = \alpha x^2/2 + C\)</span>. La constante debe ser cero pues se tiene que:</p>
<p><span class="math display">\[
\underbrace{h(x) + h(y)}_{ \alpha x^2/2 +  \alpha y^2/2 + 2C} = \underbrace{h\Big(\sqrt{x^2+y^2}\Big)}_{ \alpha(x^2+y^2)/2 + C}
\]</span></p>
<p>Al sustituir se tiene que:</p>
<p><span class="math display">\[
\ln \Big( \dfrac{f_X(x)}{f_X(0)} \Big)= \dfrac{\alpha x^2}{2}
\]</span></p>
<p>de donde despejamos y obtenemos:</p>
<p><span class="math display">\[
f_X(x) = \frac{1}{f_X(0)} e^{\frac{\alpha x^2
}{2}}
\]</span></p>
<p>Finalmente sabemos que para ser densidad debe integrar a <span class="math inline">\(1\)</span> y ser positiva (por tanto <span class="math inline">\(f_X(0) &gt; 0\)</span>) por tanto esto fuerza a <span class="math inline">\(\alpha\)</span> a ser negativo. En particular tomaremos <span class="math inline">\(\alpha = -1\)</span> por ser el negativo más sencillo para este problema (pudo haber sido cualquier otro negativo).</p>
<p><span class="math display">\[
f_X(x) = \frac{1}{f_X(0)} e^{-\frac{1}{2} x^2}
\]</span></p>
<p>Y para que integre a <span class="math inline">\(1\)</span>: <span class="math display">\[
1 = \int\limits_{-\infty}^{\infty} f_X(x) dx = \frac{1}{f_X(0)} \int\limits_{-\infty}^{\infty}  e^{-\frac{1}{2} x^2} dx
\]</span></p>
<p>Por tanto <span class="math inline">\(f_X(0) = \int\limits_{-\infty}^{\infty} e^{-\frac{1}{2} x^2} dx\)</span>. La siguiente sección se dedica a evaluar dicha integral.</p>
</div>
<div id="integración-de-la-gaussiana" class="section level1">
<h1><span class="header-section-number">2</span> Integración de la gaussiana</h1>
<p>De la sección anterior notamos que sólo nos falta por integrar:</p>
<p><span class="math display">\[
\int\limits_{-\infty}^{\infty}  e^{-\frac{1}{2} x^2} dx
\]</span></p>
<p>la cual puede reescribirse como:</p>
<p><span class="math display">\[
2 \int\limits_{0}^{\infty}  e^{-\frac{1}{2} x^2} dx
\]</span></p>
<p>Por lo que la integral a resolver en este caso es <span class="math inline">\(\int\limits_{0}^{\infty} e^{-\frac{1}{2} x^2} dx\)</span>. Para ello definiremos una función auxiliar <span class="math inline">\(g\)</span> que nos ayudará en el proceso de integración:</p>
<p><span class="math display">\[
g(t) = \Big[ \int\limits_{0}^{t}  e^{-\frac{1}{2} x^2} dx \Big]^2
\]</span></p>
<p>Notamos que:</p>
<p><span class="math display">\[
\lim_{t \to \infty} \sqrt{g(t)} = \int\limits_{0}^{\infty}  e^{-\frac{1}{2} x^2} dx
\]</span></p>
<p>De donde toda nuestra atención se enfocará en ese límite. Para resolverlo utilizaremos <a href="http://fy.chalmers.se/~tfkhj/FeynmanIntegration.pdf">el truco de Feynman</a> una técnica que no se estudia en las clases tradicionales de Cálculo<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a>.</p>
<p>La derivada de <span class="math inline">\(g\)</span> está dada por:</p>
<p><span class="math display">\[
\dfrac{dg}{dt} = 2 \Bigg[ \int\limits_{0}^{t} e^{-x^2/2}dx \Bigg] e^{-t^2/2} = 2 \int\limits_{0}^{t} e^{-(t^2+x^2)/2}dx
\]</span></p>
<p>Hacemos el cambio de variable <span class="math inline">\(u = x/t\)</span> lo que implica que <span class="math inline">\(x = ut\)</span> y que <span class="math inline">\(dx = tdu\)</span> donde además cuando <span class="math inline">\(x \in (0,t)\)</span> entonces <span class="math inline">\(u \in (0,1)\)</span>:</p>
<p><span class="math display">\[
\dfrac{dg}{dt} =  2 \int\limits_{0}^{1} t e^{-(1+u^2)t^2 /2}du
\]</span></p>
<p>Notamos que:</p>
<p><span class="math display">\[
\dfrac{\partial}{\partial t}  \Bigg[ - \dfrac{2e^{-(1+u^2)t^2/2}}{1+u^2} \Bigg] = 2te^{-(1+u^2)t^2/2}
\]</span></p>
<p>En resumen:</p>
<p><span class="math display">\[
\dfrac{dg}{dt} = \int\limits_{0}^{1} \dfrac{\partial}{\partial t}  \Bigg[ - \dfrac{2e^{-(1+u^2)t^2/2}}{1+u^2} \Bigg]  du = \dfrac{d}{d t}  \int\limits_{0}^{1}  \Bigg[ - \dfrac{2e^{-(1+u^2)t^2/2}}{1+u^2} \Bigg]  du 
\]</span></p>
<p>Por tanto, mediante integración obtenemos que:</p>
<p><span class="math display">\[
g(t) =  \int\limits_{0}^{1}  \Bigg[ - \dfrac{2e^{-(1+u^2)t^2/2}}{1+u^2} \Bigg]  du  + C
\]</span></p>
<p>Para determinar la constante de integración <span class="math inline">\(C\)</span> observamos que si <span class="math inline">\(t \to 0\)</span> se tiene:</p>
<p><span class="math display">\[
\lim_{t\to 0} g(t) = \Big[ \int\limits_{0}^{0}  e^{-\frac{1}{2} x^2} dx \Big]^2 = 0
\]</span></p>
<p>Mientras que por otro lado:</p>
<p><span class="math display">\[\begin{equation}
\begin{aligned}
\lim_{t\to 0}  g(t) &amp;=  \lim_{t\to 0}   \int\limits_{0}^{1}  \Bigg[ - \dfrac{2e^{-(1+u^2)t^2/2}}{1+u^2} \Bigg]  du  + C 
\\ &amp; = \lim_{t\to 0}   -2 \int\limits_{0}^{1}  \Bigg[  \dfrac{1}{1+u^2} \Bigg]  du  + C 
\\ &amp; = -2\arctan(u)\Bigg|_{u = 0}^{u = 1} + C 
\\ &amp; = -2 \dfrac{\pi}{4} + C 
\end{aligned}
\end{equation}\]</span></p>
<p>Por tanto, <span class="math inline">\(C = \pi/2\)</span>. Finalmente, <span class="math inline">\(g(t) = \int\limits_{0}^{1} \Bigg[ - \dfrac{2e^{-(1+u^2)t^2/2}}{1+u^2} \Bigg] du + \dfrac{\pi}{2}\)</span>. Por otro lado, notamos que:</p>
<p><span class="math display">\[
\lim_{t \to \infty} g(t) = \int\limits_{0}^{1}  \Bigg[ - \lim_{t \to \infty} \dfrac{2e^{-(1+u^2)t^2/2}}{1+u^2} \Bigg]  du  + \dfrac{\pi}{2} = \dfrac{\pi}{2}
\]</span></p>
<p>Por lo cual: <span class="math display">\[
\lim_{t \to \infty} \sqrt{g(t)} = \int\limits_{0}^{\infty}  e^{-\frac{1}{2} x^2} dx  = \sqrt{\dfrac{\pi}{2}}
\]</span></p>
<p>De donde:</p>
<p><span class="math display">\[
\int\limits_{-\infty}^{\infty}  e^{-\frac{1}{2} x^2} dx = \sqrt{2 \pi}
\]</span> Concluimos entonces que <span class="math inline">\(f_X(0) = \sqrt{2 \pi}\)</span> lo cual nos permite definir la distribución normal estándar:</p>

<div class="panel panel-default">
	<div id =  normal class="panel-heading">
		<h4> Modelo  [ Normal Estándar ] </h4>
	</div>
	<div class="panel-body">
		<i>
Una variable aleatoria $Z$ tiene una distribución $\text{NormalEstándar}$ (o $\text{Normal}(0,1)$) si:
$$
f_X(x) =  \frac{1}{\sqrt{2 \pi}} e^{-\frac{x^2}{2}} 
$$

</i>	</div>
</div>

<p>A partir de un cambio de variable podemos definir el modelo <span class="math inline">\(\text{Normal}(\mu,\sigma^2)\)</span> en general:</p>

<div class="panel panel-primary">
	<div id =  normalgral class="panel-heading">
		<h4> Teorema 1 [ Normal($\mu,\sigma$) ] </h4>
	</div>
	<div class="panel-body">
		<i>
Sea $Z$ variable aleatoria $Z$ con distribución $\text{NormalEstándar}$ (o $\text{Normal}(0,1)$). Para $\sigma > 0$ definimos una nueva variable aleatoria $X$ dada por:
$$
X = \sigma Z + \mu
$$
Entonces la función de densidad de $X$ es:
$$
f_X(x) = \dfrac{1}{\sqrt{2\pi\sigma^2}} e^{-\frac{(x-\mu)^2}{2\sigma^2}} 
$$
</i>
		<div class="well" style = "margin-top: 10px;">
			 <b>Demostración:</b> 
Operaremos con la función de distribución acumulada:
\begin{equation}
\begin{aligned}
F_X(x) & = \mathbb{P}(X \leq x) \\
& = \mathbb{P}(\sigma Z + \mu \leq x) \\
& = \mathbb{P}( Z  \leq \frac{x - \mu}{\sigma}) \\
& = F_Z\Big( \frac{x - \mu}{\sigma} \Big)
\end{aligned}
\end{equation}
de donde, al derivar, obtenemos la densidad:
\begin{equation}
\begin{aligned}
f_X(x) & = \dfrac{d}{dx} F_X(x) \\
& = \dfrac{d}{dx} F_Z\Big( \frac{x - \mu}{\sigma}  \Big) \\
& = f_Z\Big( \frac{x - \mu}{\sigma} \Big) \cdot \frac{1}{\sigma} \\
& =  \dfrac{1}{\sqrt{2\pi}} e^{-\frac{\big(\frac{x - \mu}{\sigma}\big)^2}{2}}\cdot \frac{1}{\sigma}\\
& = \dfrac{1}{\sqrt{2\pi\sigma^2}} e^{-\frac{(x-\mu)^2}{2\sigma^2}} 
\end{aligned}
\end{equation}
 
		</div>
	</div>
</div>


<div class="panel panel-default">
	<div id =  normalgral2 class="panel-heading">
		<h4> Modelo  [ Normal($\mu,\sigma$) ] </h4>
	</div>
	<div class="panel-body">
		<i>
Una variable aleatoria $X$ se distribuye $\text{Normal}(\mu,\sigma)$ si su densidad está dada por:
$$
f_X(x) = \dfrac{1}{\sqrt{2\pi\sigma^2}} e^{-\frac{(x-\mu)^2}{2\sigma^2}} 
$$
</i>	</div>
</div>

<p>La normal se ve así:</p>
<p><img src="ModeloNormal_files/figure-html/unnamed-chunk-7-1.png" width="768" style="display: block; margin: auto;" /></p>
</div>
<div id="funciones-generadoras-valor-esperado-y-otras-propiedades" class="section level1">
<h1><span class="header-section-number">3</span> Funciones generadoras, valor esperado y otras propiedades</h1>
<div id="valor-esperado-y-varianza" class="section level2">
<h2><span class="header-section-number">3.1</span> Valor esperado y varianza</h2>
<p>Podemos utilizar que cualquier variable aleatoria normal <span class="math inline">\(X\sim\text{Normal}(\mu,\sigma^2)\)</span> puede escribirse como: <span class="math display">\[
X = \sigma Z + \mu
\]</span> donde <span class="math inline">\(Z\sim\text{Normal(0,1)}\)</span> es una normal estándar. A través de propiedades de valor esperado podemos ver que:</p>
<p><span class="math display">\[\begin{equation}
\begin{aligned}
\mathbb{E}[X] &amp; = \sigma \cdot \mathbb{E}[Z] + \mu \\
\text{Var}[X] &amp; = \sigma^2 \cdot \text{Var}[Z]
\end{aligned}
\end{equation}\]</span></p>
<p>Basta entonces con calcular <span class="math inline">\(\mathbb{E}[Z]\)</span> y <span class="math inline">\(\text{Var}[Z]\)</span>: <span class="math display">\[\begin{equation}
\begin{aligned}
\mathbb{E}[Z] &amp; = \int\limits_{-\infty}^{\infty} z f_Z(z) dz \\
&amp; = \int\limits_{-\infty}^{\infty} z \dfrac{1}{\sqrt{2\pi}} e^{-\frac{z^2}{2}} dz \\
&amp; = 2 \int\limits_{0}^{\infty} z \dfrac{1}{\sqrt{2\pi}} e^{-\frac{z^2}{2}} dz \\
&amp; = 2 \int\limits_{0}^{\infty} \dfrac{1}{\sqrt{2\pi}} e^{-u} du \\
&amp; = 0.
\end{aligned}
\end{equation}\]</span> donde hicimos el cambio de variable <span class="math inline">\(u = \frac{z^2}{2}\)</span> y <span class="math inline">\(du = zdz\)</span></p>
<p>Por otro lado, bajo el cambio de variable <span class="math inline">\(u = z\)</span>, <span class="math inline">\(dv = z e^{-\frac{z^2}{2}}dz\)</span> con <span class="math inline">\(du = dz\)</span> y <span class="math inline">\(v = - e^{-\frac{z^2}{2}}\)</span> podemos calcular la varianza:</p>
<p><span class="math display">\[\begin{equation}
\begin{aligned}
\text{Var}[Z] &amp; = \int\limits_{-\infty}^{\infty} z^2 f_Z(z) dz \\
&amp; = \int\limits_{-\infty}^{\infty} z^2 \dfrac{1}{\sqrt{2\pi}} e^{-\frac{z^2}{2}} dz \\
&amp; = \dfrac{1}{\sqrt{2\pi}} \Bigg[ \underbrace{- z e^{-\frac{z^2}{2}} \bigg|_{z=0}^{z=\infty}}_{uv} + \underbrace{\int\limits_{-\infty}^{\infty} e^{-\frac{z^2}{2}} dz}_{\int v du} \Bigg] \\
&amp; = \underbrace{\int\limits_{-\infty}^{\infty} \dfrac{1}{\sqrt{2\pi}} e^{-\frac{z^2}{2}} dz }_{\text{Densidad Normal}(0,1)}¸\\
&amp; = 1
\end{aligned}
\end{equation}\]</span></p>
<p>Al combinar los resultados anteriores podemos concluir el siguiente teorema:</p>

<div class="panel panel-primary">
	<div id =  mvarnormal class="panel-heading">
		<h4> Teorema 2 [ Media y varianza de una normal ] </h4>
	</div>
	<div class="panel-body">
		<i>
Una variable aleatoria $X\sim\text{Normal}(\mu,\sigma)$ tiene media $\mu$ y varianza $\sigma^2$
</i>
		<div class="well" style = "margin-top: 10px;">
			 <b>Demostración:</b> Lo anterior 
		</div>
	</div>
</div>

</div>
<div id="moda" class="section level2">
<h2><span class="header-section-number">3.2</span> Moda</h2>
<p>La moda se define como el valor <span class="math inline">\(x\)</span> donde la densidad alcanza su máximo en el caso de las continuas. Para la <span class="math inline">\(\text{Normal}(\mu,\sigma^2)\)</span>, buscamos el valor que maximiza: <span class="math display">\[
f_X(x) = \dfrac{1}{\sqrt{2\pi\sigma^2}}e^{-\frac{(x-\mu)^2}{2\sigma^2}}
\]</span> Como la función es diferenciable, derivamos e igualamos a <span class="math inline">\(0\)</span>. Nos podemos ahorrar el <span class="math inline">\(\frac{1}{\sqrt{2\pi\sigma^2}}\)</span> por ser una constante positiva:</p>
<p><span class="math display">\[
f&#39;_X(x) = - \frac{(x-\mu)}{\sigma^2}\cdot e^{-\frac{(x-\mu)^2}{2\sigma^2}}
\]</span></p>
<p>de donde obtenemos <span class="math inline">\(x = \mu\)</span>. Para verificar que es un máximo comprobamos la convexidad en torno al punto:</p>
<p><span class="math display">\[
f&#39;&#39;_X(x) = - \frac{e^{-\frac{(x-\mu)^2}{2\sigma^2}}}{\sigma^2} + \frac{(x-\mu)^2}{\sigma^4}\cdot e^{-\frac{(x-\mu)^2}{2\sigma^2}}
\]</span></p>
<p>La convexidad cambia en <span class="math inline">\(\mu \pm \sigma^2\)</span>. En particular, dicha derivada en torno a <span class="math inline">\(x = \mu\)</span> es negativa por lo cual es cóncava y se tiene que <span class="math inline">\(\mu\)</span> es un máximo; por tanto:</p>

<div class="panel panel-primary">
	<div id =  modanormal class="panel-heading">
		<h4> Teorema 3 [ Moda de una normal ] </h4>
	</div>
	<div class="panel-body">
		<i>
Una variable aleatoria $X\sim\text{Normal}(\mu,\sigma)$ tiene moda $\mu$.
</i>
		<div class="well" style = "margin-top: 10px;">
			 <b>Demostración:</b> Lo anterior 
		</div>
	</div>
</div>

</div>
<div id="función-generadora-de-momentos" class="section level2">
<h2><span class="header-section-number">3.3</span> Función generadora de momentos</h2>
<p>La función generadora de momentos para una <span class="math inline">\(\text{Normal}(\mu,\sigma)\)</span> puede calcularse, también, a través de una <span class="math inline">\(\text{Normal}(0,1)\)</span>. Para ello sea <span class="math inline">\(X\sim \text{Normal}(\mu,\sigma)\)</span> y escribamos <span class="math inline">\(X\)</span> como <span class="math inline">\(X = \sigma Z + \mu\)</span> donde <span class="math inline">\(Z\sim\text{Normal}(0,1)\)</span>. Entonces tenemos: <span class="math display">\[
M_X(t) = \mathbb{E}[e^{tX}] = \mathbb{E}[e^{t(\sigma Z + \mu)}] = \mathbb{E}[e^{t\sigma Z}e^{t \mu}] = e^{t\mu} M_Z(\sigma t) 
\]</span> donde <span class="math inline">\(M_Z\)</span> es la función generadora de momentos de <span class="math inline">\(Z\)</span>. Calculamos entonces la de esta última:</p>
<p><span class="math display">\[\begin{equation}
\begin{aligned}
M_Z(\tau) &amp; = \mathbb{E}[e^{tZ}] \\
&amp; = \int\limits_{-\infty}^{\infty} e^{tz} \dfrac{1}{\sqrt{2\pi}}e^{-\frac{z^2}{2}} dz \\
&amp; = \int\limits_{-\infty}^{\infty} \dfrac{1}{\sqrt{2\pi}}e^{tz-\frac{z^2}{2}} dz \\
&amp; = \int\limits_{-\infty}^{\infty} \dfrac{1}{\sqrt{2\pi}}e^{-(\frac{z}{\sqrt{2}}-\frac{t}{\sqrt{2}})^2 +\frac{t^2}{2}}dz \\
&amp; = e^{\frac{t^2}{2}}\int\limits_{-\infty}^{\infty} \underbrace{\dfrac{1}{\sqrt{2\pi}}e^{-\frac{(z-t)^2}{2}}}_{\text{Normal}(t,1)} dz \\
&amp; =  e^{\frac{t^2}{2}}.
\end{aligned}
\end{equation}\]</span> Lo anterior nos permite concluir el teorema:</p>

<div class="panel panel-primary">
	<div id =  gennormal class="panel-heading">
		<h4> Teorema 4 [ Generadora de momentos de una normal ] </h4>
	</div>
	<div class="panel-body">
		<i>
Una variable aleatoria $X\sim\text{Normal}(\mu,\sigma)$ tiene función generadora de momentos: 
$$
M_X(t) = e^{\mu t + \frac{t^2 \sigma^2}{2}}
$$
</i>
		<div class="well" style = "margin-top: 10px;">
			 <b>Demostración:</b> Lo anterior 
		</div>
	</div>
</div>

</div>
<div id="mediana" class="section level2">
<h2><span class="header-section-number">3.4</span> Mediana</h2>
<p>Para encontrar la mediana de una variable aleatoria normal utilizaremos un teorema mucho más general que establece que, si una densidad es simétrica en torno a un valor <span class="math inline">\(m\)</span> entonces <span class="math inline">\(m\)</span> es la mediana. Esto lo podemos ver, intuitivamente, en la gráfica inferior con una densidad Laplace:</p>
<p><img src="ModeloNormal_files/figure-html/unnamed-chunk-11-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>Lo cual nos inspira para el siguiente teorema: 
<div class="panel panel-primary">
	<div id =  medianasim class="panel-heading">
		<h4> Teorema 5 [ Mediana de simétricas ] </h4>
	</div>
	<div class="panel-body">
		<i>
Sea $X$ una variable aleatoria continua  con densidad $f_X$ simétrica en torno a $m$; es decir:
$$
f_X(m + x) = f_X(m - x)
$$
Entonces $m$ es la mediana de la distribución. 
</i>
		<div class="well" style = "margin-top: 10px;">
			 <b>Demostración:</b> 
Notamos que:
\begin{equation}
\begin{aligned}
1 & = \int\limits_{-\infty}^{\infty} f_X(x) dx \\
& = \underbrace{\int\limits_{-\infty}^{0} f_X(x) dx}_{u = m-x; du = -dx} + \underbrace{\int\limits_{0}^{\infty} f_X(x) dx}_{w = m + x; dw = dx} \\
& = - \int\limits_{\infty}^{m} f_X(u) du + \int\limits_{m}^{\infty} f_X(w) dw \\
& = 2 \int\limits_{m}^{\infty} f_X(w) dw 
\end{aligned} 
\end{equation}
Lo cual implica que:
$$
P(X \geq m) = 1 - P(X \leq m) = \int\limits_{m}^{\infty} f_X(w) dw =  \dfrac{1}{2}
$$
y por tanto $m$ es la mediana. 
 
		</div>
	</div>
</div>
</p>
<p>En particular, como una normal es simétrica en torno a <span class="math inline">\(\mu\)</span> tenemos el siguiente teorema:</p>

<div class="panel panel-primary">
	<div id =  mednormal class="panel-heading">
		<h4> Teorema 6 [ Mediana de una normal ] </h4>
	</div>
	<div class="panel-body">
		<i>
Una variable aleatoria $X\sim\text{Normal}(\mu,\sigma)$ tiene mediana:
$$
\text{Mediana}[X] = \mu
$$
</i>
		<div class="well" style = "margin-top: 10px;">
			 <b>Demostración:</b> La simetría de la normal. 
		</div>
	</div>
</div>

</div>
</div>
<div id="teorema-central-del-límite" class="section level1">
<h1><span class="header-section-number">4</span> Teorema central del límite</h1>
<p>Esta sección contiene sólo una introducción a un tema que nos dice por qué la normal es tan importante. Para ver esto, haremos un análisis de distribuciones conocidas. El proceso de simulación es el siguiente:</p>
<ol style="list-style-type: decimal">
<li><p>Tomaré una muestra aleatoria <span class="math inline">\(M_i = \{X_1, X_2,\dots,X_n \}\)</span> de <span class="math inline">\(n\)</span> variables aleatorias independientes todas con la misma distribución. Supongamos que dichas variables tienen media finita <span class="math inline">\(\mu\)</span>, varianza finita <span class="math inline">\(\sigma^2 &gt; 0\)</span> y su generadora de momentos existe para algún intervalo abierto.</p></li>
<li><p>Calcularé:</p></li>
</ol>
<p><span class="math display">\[
Z_i(n) = \sqrt{n} \Big( \dfrac{1}{n}\sum\limits_{k=1}^{n} X_k - \mu \Big)
\]</span></p>
<ol start="3" style="list-style-type: decimal">
<li>Repetiré el proceso para <span class="math inline">\(i = 1,\dots, 1000\)</span> y graficaré un histograma de dichas muestras. Notaremos que conforme aumentamos el tamaño de muestra <span class="math inline">\(n\)</span>, las <span class="math inline">\(Z_i\)</span> se aproximan en distirbución a una normal con varianza <span class="math inline">\(\sigma^2\)</span>.</li>
</ol>
<p>El siguiente código de <code>R</code> ejecuta las simulaciones:</p>
<pre class="r"><code>TeoremaCentralLimite &lt;- function(numero_simulaciones = 1000, n = c(10,100,1000,10000), 
                                 distribucion = rpois, mu = 1, sigma = 1, bins = 50, 
                                 ncol = 2, distname = &quot;Poisson(1)&quot;, 
                                 rcolor = sample(rainbow(100),1), ...){
  #Creamos
  plot_list &lt;- list()
  
  for (k in n){
    
    #Guardamos las Zi en un vector
    Z &lt;- rep(NA, numero_simulaciones)
    
    #Simulamos todas las simulaciones
    for (i in 1:numero_simulaciones){
      simulaciones_X &lt;- distribucion(n = k, ...)
      Z[i]         &lt;- sqrt(k)*(sum(simulaciones_X/k) - mu)
    }
    
    #Graficación
    x &lt;- seq(min(Z)-1, max(Z) + 1, length.out = 1000)
    y &lt;- dnorm(x, sd = sigma)
    plot_list &lt;- list.append(
      plot_list, 
      ggplot() + 
      geom_histogram(aes(x = Z, y = ..density..), bins = bins, fill = rcolor, 
                     data = data.frame(Z = Z)) +
      geom_line(aes_string(x = x, y = y), color = &quot;black&quot;, data = data.frame(x = x, y = y)) +
      ggtitle(paste0(&quot;Simulaciones con &quot;, distname,&quot;\nn = &quot;, k)) +
      xlab(&quot;Z&quot;) + ylab(&quot;Densidad de Z&quot;) +
      theme_bw()
    )
  }
  do.call(&quot;grid.arrange&quot;, c(plot_list, ncol = ncol))
}</code></pre>
<p>Para la Poisson:</p>
<pre class="r"><code>TeoremaCentralLimite(lambda = 1, distname = &quot;Poisson(1)&quot;)</code></pre>
<p><img src="ModeloNormal_files/figure-html/unnamed-chunk-15-1.png" width="960" style="display: block; margin: auto;" /></p>
<p>Uniforme:</p>
<pre class="r"><code>TeoremaCentralLimite(distribucion = runif, mu = 1/2, sigma = 1/12, distname = &quot;Uniforme(0,1)&quot;)</code></pre>
<p><img src="ModeloNormal_files/figure-html/unnamed-chunk-16-1.png" width="960" style="display: block; margin: auto;" /></p>
<p>Exponencial</p>
<pre class="r"><code>TeoremaCentralLimite(distribucion = rexp, mu = 1/5, sigma = 1/25, rate = 5, distname = &quot;Exp(5)&quot;)</code></pre>
<p><img src="ModeloNormal_files/figure-html/unnamed-chunk-17-1.png" width="960" style="display: block; margin: auto;" /></p>
<p>Gama:</p>
<pre class="r"><code>TeoremaCentralLimite(distribucion = rgamma, mu = 1, sigma = 0.5, shape = 2, scale = 0.5, distname = &quot;Gama(2,1/2)&quot;)</code></pre>
<p><img src="ModeloNormal_files/figure-html/unnamed-chunk-18-1.png" width="960" style="display: block; margin: auto;" /></p>
<p>E inclusive la binomial</p>
<pre class="r"><code>TeoremaCentralLimite(distribucion = rbinom, mu = 4.5, sigma = 2.475, size = 10, prob = 0.45, distname = &quot;Binomial(10,0.45)&quot;)</code></pre>
<p><img src="ModeloNormal_files/figure-html/unnamed-chunk-19-1.png" width="960" style="display: block; margin: auto;" /></p>
<p>Observa que todas poco a poco empiezan a tomar una forma de una curva normal. Lo que está pasando es el Teorema Central del Límite. El cual nos indica que, cuando <span class="math inline">\(n \to \infty\)</span></p>
<p><span class="math display">\[
\lim_{n\to\infty} Z(n) = \lim_{n\to\infty} \sqrt{n} \Big( \dfrac{1}{n}\sum\limits_{k=1}^{n} X_k - \mu \Big) \sim \textrm{Normal}(0,\sigma^2)
\]</span></p>
<p>Podemos reescribir esto en el siguiente teorema:</p>

<div class="panel panel-primary">
	<div id =  TCL class="panel-heading">
		<h4> Teorema 7 [ Teorema del Límite Central ] </h4>
	</div>
	<div class="panel-body">
		<i>
Sean $X_1,X_2,\dots,$ variables aleatorias independientes idénticamente distribuidas con media finita $\mu$ y varianza finita $\sigma^2 > 0$. Luego: 
$$
 \lim_{n\to\infty} \dfrac{\sum\limits_{k=1}^{n} X_k - n \mu}{ \sqrt{n \sigma^2}} \sim \textrm{Normal}(0,1)
$$
</i>
		<div class="well" style = "margin-top: 10px;">
			 <b>Demostración:</b> Muy complicada para Proba 1 
		</div>
	</div>
</div>

</div>
<div id="distribución-lognormal" class="section level1">
<h1><span class="header-section-number">5</span> Distribución lognormal</h1>
<div id="idea" class="section level2">
<h2><span class="header-section-number">5.1</span> Idea</h2>
</div>
<div id="media-y-varianza" class="section level2">
<h2><span class="header-section-number">5.2</span> Media y varianza</h2>
</div>
<div id="generadora-de-momentos" class="section level2">
<h2><span class="header-section-number">5.3</span> ¿Generadora de momentos?</h2>
</div>
</div>
<div class="footnotes">
<hr />
<ol>
<li id="fn1"><p>Otra opción es usar integrales polares pero no necesariamente todos sabemos hacerlo.<a href="#fnref1" class="footnote-back">↩</a></p></li>
</ol>
</div>

<div class="panel panel-default">
    <div class="panel-body">
      <b>Contáctame</b> en <a href="mailto:rodrigo.zepeda@itam.mx?Subject=Notas de Proba 1" target="_top">rodrigo.zepeda@itam.mx</a>
    </div>
    <div class="panel-footer"><span  xmlns:dct="http://purl.org/dc/terms/" property="dct:title"><small><b>Notas de Cálculo de Probabilidades</b></span> por <span xmlns:cc="http://creativecommons.org/ns#" property="cc:attributionName">Rodrigo Zepeda</span> tiene una licencia <a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/">Creative Commons Attribution-NonCommercial 4.0 International License</a>. </small><br /></div>
</div>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
